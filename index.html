<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StyleSense - Clothing Feedback Analyzer</title>
    
    <!-- SheetJS for reading Excel files -->
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font and Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(226, 232, 240, 0.8); }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen text-slate-800 bg-slate-50">

    <div class="max-w-6xl mx-auto space-y-6">
        
        <!-- Header -->
        <div class="text-center mb-8 pt-4">
            <h1 class="text-3xl font-bold text-indigo-700 tracking-tight">StyleSense Intelligence</h1>
            <p class="text-slate-500 mt-2">Batch process customer feedback to extract insights per product.</p>
        </div>

        <!-- Upload & Action -->
        <div class="glass p-8 rounded-xl shadow-sm flex flex-col items-center justify-center gap-6 bg-white max-w-2xl mx-auto">
            <div class="w-full text-center">
                <label class="block text-lg font-bold text-slate-700 mb-4">Upload Feedback File</label>
                
                <div class="relative group">
                    <input type="file" id="fileInput" accept=".csv, .xlsx, .xls, .json, .txt" 
                        class="block w-full text-sm text-slate-500 file:mr-4 file:py-3 file:px-6 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 transition cursor-pointer border-2 border-dashed border-slate-300 rounded-xl bg-slate-50 p-8 text-center"/>
                </div>
                <p class="text-xs text-slate-400 mt-3">Supports Excel (.xlsx), CSV, JSON, or Text files.</p>
            </div>
            
            <button onclick="processData()" class="w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white px-10 py-3 rounded-lg font-bold shadow-lg shadow-indigo-200 transition transform hover:-translate-y-0.5 flex items-center justify-center gap-2 whitespace-nowrap text-lg">
                <span>Start Batch Analysis</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
            </button>
        </div>

        <!-- Status Bar (Hidden initially) -->
        <div id="statusArea" style="display: none;" class="glass p-6 rounded-xl shadow-sm fade-in bg-white max-w-4xl mx-auto">
            <div class="flex justify-between mb-2">
                <span id="statusLabel" class="font-semibold text-indigo-600 flex items-center gap-2">
                    <!-- Text updated by script.js -->
                    Initializing...
                </span>
            </div>
            <div class="w-full bg-slate-200 rounded-full h-3 overflow-hidden">
                <div id="progressFill" class="bg-indigo-600 h-3 rounded-full transition-all duration-300 shadow-[0_0_10px_rgba(79,70,229,0.5)]" style="width: 0%"></div>
            </div>
        </div>

        <!-- Download Report Button (Hidden initially) -->
        <div class="text-center">
            <button id="reportBtn" onclick="generateReport()" style="display: none;" class="bg-emerald-600 hover:bg-emerald-700 text-white px-8 py-3 rounded-lg shadow-lg shadow-emerald-200 transition items-center gap-2 fade-in font-medium mx-auto">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                Download Full Report (.txt)
            </button>
        </div>

        <!-- Results Table (Hidden initially) -->
        <div id="tableContainer" style="display: none;" class="glass rounded-xl shadow-sm overflow-hidden fade-in border border-slate-200 bg-white">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-200">
                    <thead class="bg-slate-50">
                        <tr>
                            <!-- These headers match the data extracted in script.js -->
                            <th class="px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider w-[15%]">Clothing ID</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider w-[15%]">Sentiment</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider w-[30%]">Key Issues</th>
                            <th class="px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase tracking-wider w-[40%]">Summary</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="bg-white divide-y divide-slate-100 text-sm">
                        <!-- Rows injected here by script.js -->
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- LINK TO YOUR EXTERNAL SCRIPT -->
    <script src="script.js"></script>
</body>
</html>
